(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{216:function(t,e,r){"use strict";r.r(e);var i=r(0),n=Object(i.a)({},(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"content"},[t._m(0),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),r("p",[t._v("遇到过一个 bug，管理后台有一个富文本。有一天报了一个 bug，说它复制内容到富文本里面之后保存，总是会缺失一部分内容。刚开始以为是富文本的问题，经过仔细排查之后发现是后端存储的问题。")]),t._v(" "),t._m(3),t._v(" "),t._m(4),t._v(" "),t._m(5),t._v(" "),r("p",[t._v("很多人都应该听过或者用过 Gzip，知道它能压缩静态资源，但很少有人知道它具体的工作原理。")]),t._v(" "),t._m(6),t._v(" "),r("p",[t._v("Gzip 的核心是 "),r("a",{attrs:{href:"https://zh.wikipedia.org/wiki/DEFLATE",target:"_blank",rel:"noopener noreferrer"}},[t._v("Deflate"),r("OutboundLink")],1),t._v(" 算法 - 它是同时使用了 LZ77 算法与哈夫曼编码（Huffman Coding）的一个无损数据压缩算法。")]),t._v(" "),r("p",[t._v("LZ77 的核心思路是如果一个串中有两个重复的串，那么只需要知道第一个串的内容和后面串相对于第一个串起始位置的距离 + 串的长度。\n比如： ABCDEFGABCDEFH → ABCDEFG(7,6)H。7 指的是往前第 7 个数开始，6 指的是重复串的长度，ABCDEFG(7,6)H 完全可以表示前面的串，并且是没有二义性的。")]),t._v(" "),r("p",[t._v("Huffman Coding 是大学课本中一般都会提到的算法。核心思路是通过构造 Huffman Tree 的方式给字符重新编码（核心是避免一个叶子的路径是另外一个叶子路径的前缀），以保证出现频路越高的字符占用的字节越少")]),t._v(" "),r("p",[t._v("详细的算法可以见这篇"),r("a",{attrs:{href:"https://blog.csdn.net/imquestion/article/details/16439",target:"_blank",rel:"noopener noreferrer"}},[t._v("文章"),r("OutboundLink")],1),t._v("。")]),t._v(" "),t._m(7),t._v(" "),r("p",[r("a",{attrs:{href:"https://draveness.me/dns-coredns",target:"_blank",rel:"noopener noreferrer"}},[t._v("详解 DNS 与 CoreDNS 的实现原理"),r("OutboundLink")],1)]),t._v(" "),t._m(8),t._v(" "),r("p",[t._v("又是一个老生常谈的问题，这里就不想说了，有需求的自己看 "),r("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS",target:"_blank",rel:"noopener noreferrer"}},[t._v("MDN"),r("OutboundLink")],1),t._v("就可以了。")]),t._v(" "),t._m(9),t._v(" "),t._m(10),t._v(" "),t._m(11),t._v(" "),t._m(12),t._v(" "),t._m(13),t._v(" "),r("p",[t._v("而且还要注意一点，也不是只有"),r("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest",target:"_blank",rel:"noopener noreferrer"}},[t._v("XMLHttpRequest"),r("OutboundLink")],1),t._v("或者 "),r("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API",target:"_blank",rel:"noopener noreferrer"}},[t._v("fetch"),r("OutboundLink")],1),t._v("请求才会有跨域问题，使用 drawImage 的 canvas、web 字体 、CSSDOM 也都是有这问题的。")])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{attrs:{id:"cs"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#cs","aria-hidden":"true"}},[this._v("#")]),this._v(" CS")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"mysql"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mysql","aria-hidden":"true"}},[this._v("#")]),this._v(" MySQL")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"utf8mb4"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#utf8mb4","aria-hidden":"true"}},[this._v("#")]),this._v(" utf8mb4")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("后端的 MySQL 用的是"),e("code",[this._v("utf8")]),this._v("格式的，所以 emoji 根本就存不了，所以导致这个 emoji 之后的内容都丢失了。如果你想让数据库支持 emoji 的话，就需要改成"),e("code",[this._v("utf8mb4")]),this._v("。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"gzip"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#gzip","aria-hidden":"true"}},[this._v("#")]),this._v(" Gzip")])},function(){var t=this.$createElement,e=this._self._c||t;return e("blockquote",[e("p",[this._v("2018-11-13")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("浏览器请求 url，并在 request header 中设置属性 accept-encoding:gzip。表明浏览器支持 gzip。")]),this._v(" "),e("li",[this._v("服务器收到浏览器发送的请求之后，判断浏览器是否支持 gzip，如果支持 gzip，则向浏览器传送压缩过的内容，不支持则向浏览器发送未经压缩的内容。一般情况下，浏览器和服务器都支持 gzip，response headers 返回包含 content-encoding:gzip。")]),this._v(" "),e("li",[this._v("浏览器接收到服务器的响应之后判断内容是否被压缩，如果被压缩则解压缩显示页面内容。")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"dns"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#dns","aria-hidden":"true"}},[this._v("#")]),this._v(" DNS")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"cors"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#cors","aria-hidden":"true"}},[this._v("#")]),this._v(" Cors")])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("p",[t._v("这里要说明一个问题：不是所有的跨域情况下的请求都需要先发送一个 "),r("code",[t._v("options")]),t._v(" 请求的。比如一些简单请求是不需要的\n比如"),r("code",[t._v("get")]),t._v("请求，但也不是所有的 "),r("code",[t._v("get")]),t._v("请求都不会发"),r("code",[t._v("options")]),t._v("。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("它的 "),e("code",[this._v("Content-Type")]),this._v(" 的值仅限于下列三者之一：")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[e("code",[this._v("text/plain")])]),this._v(" "),e("li",[e("code",[this._v("multipart/form-data")])]),this._v(" "),e("li",[e("code",[this._v("application/x-www-form-urlencoded")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("并且没有设置如下的 自定义"),e("code",[this._v("Header")])])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ul",[r("li",[t._v("Accept")]),t._v(" "),r("li",[t._v("Accept-Language")]),t._v(" "),r("li",[t._v("Content-Language")]),t._v(" "),r("li",[t._v("Content-Type （需要注意额外的限制）")]),t._v(" "),r("li",[t._v("DPR")]),t._v(" "),r("li",[t._v("Downlink")]),t._v(" "),r("li",[t._v("Save-Data")]),t._v(" "),r("li",[t._v("Viewport-Width")]),t._v(" "),r("li",[t._v("Width")])])}],!1,null,null,null);e.default=n.exports}}]);